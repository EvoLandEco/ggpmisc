<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>stat_peaks. ggpmisc 0.2.9</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">ggpmisc 0.2.9</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Find peaks and valleys.</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>stat_peaks(mapping&nbsp;=&nbsp;NULL, data&nbsp;=&nbsp;NULL, geom&nbsp;=&nbsp;"point", span&nbsp;=&nbsp;5, ignore_threshold&nbsp;=&nbsp;0, strict&nbsp;=&nbsp;FALSE, label.fmt&nbsp;=&nbsp;"%.4g", x.label.fmt&nbsp;=&nbsp;NULL, y.label.fmt&nbsp;=&nbsp;label.fmt, position&nbsp;=&nbsp;"identity", na.rm&nbsp;=&nbsp;FALSE, show.legend&nbsp;=&nbsp;FALSE, inherit.aes&nbsp;=&nbsp;TRUE, ...)</div>
<div>stat_valleys(mapping&nbsp;=&nbsp;NULL, data&nbsp;=&nbsp;NULL, geom&nbsp;=&nbsp;"point", span&nbsp;=&nbsp;5, ignore_threshold&nbsp;=&nbsp;0, strict&nbsp;=&nbsp;FALSE, label.fmt&nbsp;=&nbsp;"%.4g", x.label.fmt&nbsp;=&nbsp;NULL, y.label.fmt&nbsp;=&nbsp;label.fmt, position&nbsp;=&nbsp;"identity", na.rm&nbsp;=&nbsp;FALSE, show.legend&nbsp;=&nbsp;FALSE, inherit.aes&nbsp;=&nbsp;TRUE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>mapping</dt>
      <dd>The aesthetic mapping, usually constructed with
<code><a href='http://www.inside-r.org/packages/cran/ggplot2/docs/aes'>aes</a></code> or <code><a href='http://www.inside-r.org/packages/cran/ggplot2/docs/aes_'>aes_string</a></code>. Only needs
to be set
 at the layer level if you are overriding the plot defaults.</dd>
      <dt>data</dt>
      <dd>A layer specific dataset - only needed if you want to override
the plot defaults.</dd>
      <dt>geom</dt>
      <dd>The geometric object to use display the data</dd>
      <dt>span</dt>
      <dd>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element. The default value is 5, meaning that a peak is bigger than two
consequtive neighbors on each side. A <code>NULL</code> value for <code>span</code>
is taken as a span covering the whole of the data range.</dd>
      <dt>ignore_threshold</dt>
      <dd>numeric value between 0.0 and 1.0 indicating the size
threshold below which peaks will be ignored.</dd>
      <dt>strict</dt>
      <dd>logical flag: if TRUE, an element must be strictly greater than
all other values in its window to be considered a peak. Default: FALSE.</dd>
      <dt>label.fmt</dt>
      <dd>character  string giving a format definition for converting
values into character strings by means of function <code><a href='http://www.inside-r.org/r-doc/base/sprintf'>sprintf</a></code>.</dd>
      <dt>x.label.fmt</dt>
      <dd>character  string giving a format definition for converting
$x$-values into character strings by means of function <code><a href='http://www.inside-r.org/r-doc/base/sprintf'>sprintf</a></code>
or <code><a href='http://www.inside-r.org/r-doc/base/strptime'>strftime</a></code>.</dd>
      <dt>y.label.fmt</dt>
      <dd>character  string giving a format definition for converting
$y$-values into character strings by means of function <code><a href='http://www.inside-r.org/r-doc/base/sprintf'>sprintf</a></code>.</dd>
      <dt>position</dt>
      <dd>The position adjustment to use for overlapping points
on this layer</dd>
      <dt>na.rm</dt>
      <dd>a logical value indicating whether NA values should be
stripped before the computation proceeds.</dd>
      <dt>show.legend</dt>
      <dd>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</dd>
      <dt>inherit.aes</dt>
      <dd>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href='http://www.inside-r.org/packages/cran/ggplot2/docs/borders'>borders</a></code>.</dd>
      <dt>...</dt>
      <dd>other arguments passed on to <code><a href='http://www.inside-r.org/packages/cran/ggplot2/docs/layer'>layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href='http://www.inside-r.org/packages/cran/ggplot2/docs/layer'>layer</a></code> for more details.</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>

      <p><code>stat_peaks</code> finds at which x positions of local y maxima are located and
<code>stat_valleys</code> finds at which x positions local y minima are located.
Both stats return x and y numeric values for the peaks and formatted
character labels. The formatting is determined by a format string suitable
for <code>sprintf()</code>.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>These stats use <code>geom_point</code> by default as it is the geom most
  likely to work well in almost any situation without need of tweaking. The
  default aesthetics set by these stats allow their direct use with
  <code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
  <code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
  returned can be controlled by the user.</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>

      <p>This stats check the scale of the <code>x</code> aesthetic and if is Datetime it
  correctly generates the labels by transforming the numeric x values to
  POSIXct objects, in which case the <code>x.label.fmt</code> must be suitable for
  <code>strftime()</code> rather than for <code>sprintf()</code>.
These stats work nicely together with geoms
  <code><a href='http://www.inside-r.org/packages/cran/ggrepel/docs/geom_text_repel'>geom_text_repel</a></code> and
  <code><a href='http://www.inside-r.org/packages/cran/ggrepel/docs/geom_text_repel'>geom_label_repel</a></code> from package
  <code><a href='http://www.inside-r.org/packages/cran/ggrepel/docs/ggrepel'>ggrepel</a></code> to solve the problem of overlapping labels
  by displacing them. To discard overlapping labels use <code>check_overlap =
  TRUE</code> as argument to <code>geom_text</code>.
 By default the labels are character values suitable to be plotted as is, but
 with a suitable <code>label.fmt</code> labels suitable for parsing by the geoms
 (e.g. into expressions containing greek letters or super or subscripts) can
 be also easily obtained.</p>
  
    </div>

    <div class="Computed variables">
      <h2>Computed variables</h2>

      <p></p>
  
      <p><dl>
  <dt>x</dt><dd>x-value at the peak (or valley) as numeric</dd></p>
  
      <p><dt>y</dt><dd>y-value at the peak (or valley) as numeric</dd></p>
  
      <p><dt>x.label</dt><dd>x-value at the peak (or valley) as character</dd></p>
  
      <p><dt>y.label</dt><dd>y-value at the peak (or valley) as character</dd></p>
  
      <p></dl></p>
  
      <p></p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>library(ggplot2)
lynx.df &lt;- data.frame(year = as.numeric(time(lynx)), lynx = as.matrix(lynx))
ggplot(lynx.df, aes(year, lynx)) + geom_line() +
  stat_peaks(colour = &quot;red&quot;) +
  stat_valleys(colour = &quot;blue&quot;)
</div>
<p><img src='stat_peaks-2.png' alt='' width='540' height='400' /></p>
<div class='input'>ggplot(lynx.df, aes(year, lynx)) + geom_line() +
  stat_peaks(colour = &quot;red&quot;) +
  stat_peaks(colour = &quot;red&quot;, geom = &quot;rug&quot;)
</div>
<p><img src='stat_peaks-4.png' alt='' width='540' height='400' /></p>
<div class='input'></div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>stat_peaks</li><li>stat_valleys</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
Other peaks.and.valleys.functions: <code><a href='find_peaks.html'>find_peaks</a></code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="https://getbootstrap.com/2.0.4/">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>